<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–£—Ç—Ä–µ–Ω–Ω—è—è —Ä—É—Ç–∏–Ω–∞ ‚Äî –ø—Ä–æ—Ç–æ—Ç–∏–ø</title>
  
  <meta name="theme-color" content="#1976d2">
  <meta name="description" content="–ü—Ä–æ—Å—Ç–æ–π –ø—Ä–æ—Ç–æ—Ç–∏–ø —É—Ç—Ä–µ–Ω–Ω–µ–π —Ä—É—Ç–∏–Ω—ã">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="mobile-web-app-capable" content="yes">

  <link rel="manifest" href="./manifest.json">

  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: system-ui, -apple-system, sans-serif;
      background: #f8f9fa;
      color: #333;
      height: 100vh;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      position: relative;
      touch-action: pan-y;
    }
    header {
      background: #1976d2;
      color: white;
      padding: 16px;
      text-align: center;
      font-weight: 600;
      font-size: 1.2rem;
      z-index: 5;
    }
    .current-task {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 24px;
      text-align: center;
      background: white;
      z-index: 1;
    }
    .current-task h2 {
      font-size: 2rem;
      margin-bottom: 32px;
      transition: all 0.3s;
    }
    .time { font-size: 1.1rem; color: #666; margin-bottom: 24px; }
    .buttons {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
      justify-content: center;
    }
    button {
      padding: 16px 32px;
      font-size: 1.15rem;
      border: none;
      border-radius: 12px;
      color: white;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
      overflow: hidden;
    }
    .btn-confirm { background: #4caf50; }
    .btn-skip    { background: #ff9800; }
    .btn-edit    { background: #2196f3; }
    button:active { transform: scale(0.95); }

    /* –ê–Ω–∏–º–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è */
    @keyframes successPulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    .side-drawer {
      position: fixed;
      top: 0; right: 0; bottom: 0;
      width: 100%;
      background: white;
      box-shadow: -6px 0 24px rgba(0,0,0,0.18);
      transform: translateX(100%);
      transition: transform 0.4s ease-out;
      z-index: 10;
      display: flex;
      flex-direction: column;
    }
    .side-drawer.open { transform: translateX(0); }

    .drawer-header {
      padding: 16px;
      font-weight: 600;
      text-align: center;
      border-bottom: 1px solid #eee;
      background: #f8f9fa;
    }
    .task-list {
      padding: 16px;
      overflow-y: auto;
      flex: 1;
      position: relative;
    }
    .task-item {
      padding: 14px 0;
      border-bottom: 1px solid #eee;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.3s;
    }
    .task-item:last-child { border-bottom: none; }

    .status-todo    { color: #9e9e9e; }
    .status-current { 
      color: #000; 
      font-weight: 700; 
      background: #f0f8ff; 
      padding: 4px 8px; 
      border-radius: 8px;
      animation: successPulse 0.5s;
    }
    .status-done    { 
      color: #4caf50; 
      text-decoration: line-through;
      opacity: 0.7;
    }
    .status-skipped { 
      color: #ff9800; 
      text-decoration: line-through;
      opacity: 0.7;
    }
    .status-edited  { color: #2196f3; }

    .task-list::after {
      content: "";
      position: absolute;
      bottom: 0; left: 0; right: 0;
      height: 100px;
      background: linear-gradient(to bottom, transparent, white);
      pointer-events: none;
    }

    .overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.3);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.4s;
      z-index: 9;
    }
    .overlay.open { opacity: 1; pointer-events: auto; }

    /* –¢–æ—Å—Ç-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
    .toast {
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%) translateY(200px);
      background: #323232;
      color: white;
      padding: 16px 24px;
      border-radius: 8px;
      font-size: 1rem;
      z-index: 1000;
      transition: transform 0.3s ease-out;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }
    .toast.show {
      transform: translateX(-50%) translateY(0);
    }
    .toast.success { background: #4caf50; }
    .toast.warning { background: #ff9800; }
    .toast.info { background: #2196f3; }

    /* –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è */
    .completed-overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(76, 175, 80, 0.95);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1001;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.5s;
    }
    .completed-overlay.show {
      opacity: 1;
      pointer-events: auto;
    }
    .completed-overlay h1 {
      color: white;
      font-size: 3rem;
      margin-bottom: 20px;
    }
    .completed-overlay p {
      color: white;
      font-size: 1.3rem;
    }

    /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è */
    .edit-modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.9);
      background: white;
      border-radius: 16px;
      padding: 24px;
      width: 90%;
      max-width: 400px;
      z-index: 1002;
      opacity: 0;
      pointer-events: none;
      transition: all 0.3s;
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    }
    .edit-modal.show {
      opacity: 1;
      pointer-events: auto;
      transform: translate(-50%, -50%) scale(1);
    }
    .edit-modal h3 {
      margin-bottom: 16px;
      color: #333;
    }
    .edit-modal input {
      width: 100%;
      padding: 12px;
      font-size: 1rem;
      border: 2px solid #ddd;
      border-radius: 8px;
      margin-bottom: 16px;
    }
    .edit-modal-buttons {
      display: flex;
      gap: 12px;
    }
    .edit-modal button {
      flex: 1;
      padding: 12px;
    }
  </style>
</head>
<body>

  <header>–£—Ç—Ä–µ–Ω–Ω—è—è —Ä—É—Ç–∏–Ω–∞ ‚Äî 17 —è–Ω–≤–∞—Ä—è 2026</header>

  <div class="current-task">
    <div class="time" id="timeInfo">–ü—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –≤ 07:15</div>
    <h2 id="taskTitle">–ü–æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ—Ñ–µ ‚òï</h2>

    <div class="buttons">
      <button class="btn-confirm" onclick="confirmTask()">‚úì –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
      <button class="btn-skip" onclick="skipTask()">‚äò –û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
      <button class="btn-edit" onclick="openEditModal()">‚úé –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å</button>
    </div>
  </div>

  <div class="side-drawer" id="drawer">
    <div class="drawer-header">–ü–ª–∞–Ω –¥–Ω—è</div>
    <div class="task-list" id="taskList">
      <div class="task-item status-current" data-index="0">1. –ü–æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ—Ñ–µ ‚òï</div>
      <div class="task-item status-todo" data-index="1">2. –ó–∞—Ä—è–¥–∫–∞ 10 –º–∏–Ω üèãÔ∏è‚Äç‚ôÇÔ∏è</div>
      <div class="task-item status-todo" data-index="2">3. –ü—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å –∑–∞–≤—Ç—Ä–∞–∫ üç≥</div>
      <div class="task-item status-todo" data-index="3">4. –î—É—à –∏ —Å–±–æ—Ä—ã üöø</div>
      <div class="task-item status-todo" data-index="4">5. –í—ã—Ö–æ–¥ –∏–∑ –¥–æ–º–∞ üè†‚Üíüö∂</div>
    </div>
  </div>

  <div class="overlay" id="overlay" onclick="closeDrawer()"></div>

  <!-- –¢–æ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ -->
  <div class="toast" id="toast"></div>

  <!-- –≠–∫—Ä–∞–Ω –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è -->
  <div class="completed-overlay" id="completedOverlay">
    <h1>üéâ –û—Ç–ª–∏—á–Ω–æ!</h1>
    <p>–í—Å–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã!</p>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
  <div class="edit-modal" id="editModal">
    <h3>–ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∑–∞–¥–∞—á—É</h3>
    <input type="text" id="editInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç –∑–∞–¥–∞—á–∏">
    <div class="edit-modal-buttons">
      <button class="btn-skip" onclick="closeEditModal()">–û—Ç–º–µ–Ω–∞</button>
      <button class="btn-confirm" onclick="saveEdit()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </div>
  </div>

  <script>
    const drawer = document.getElementById('drawer');
    const overlay = document.getElementById('overlay');
    const toast = document.getElementById('toast');
    const taskTitle = document.getElementById('taskTitle');
    const timeInfo = document.getElementById('timeInfo');
    const completedOverlay = document.getElementById('completedOverlay');
    const editModal = document.getElementById('editModal');
    const editInput = document.getElementById('editInput');
    const taskList = document.getElementById('taskList');
    
    let currentTaskIndex = 0;
    const tasks = Array.from(document.querySelectorAll('.task-item'));

    function openDrawer() { 
      drawer.classList.add('open'); 
      overlay.classList.add('open'); 
    }
    
    function closeDrawer() { 
      drawer.classList.remove('open'); 
      overlay.classList.remove('open'); 
    }

    function showToast(message, type = 'info') {
      toast.textContent = message;
      toast.className = `toast ${type}`;
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 2000);
    }

    function updateTaskDisplay() {
      if (currentTaskIndex < tasks.length) {
        const taskText = tasks[currentTaskIndex].textContent;
        taskTitle.textContent = taskText.substring(3); // —É–±–∏—Ä–∞–µ–º –Ω–æ–º–µ—Ä
        const now = new Date();
        const time = now.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
        timeInfo.textContent = `–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è: ${time}`;
      }
    }

    function confirmTask() {
      if (currentTaskIndex >= tasks.length) return;
      
      tasks[currentTaskIndex].className = 'task-item status-done';
      showToast('‚úì –ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞!', 'success');
      
      taskTitle.style.animation = 'successPulse 0.5s';
      setTimeout(() => { taskTitle.style.animation = ''; }, 500);
      
      currentTaskIndex++;
      
      if (currentTaskIndex < tasks.length) {
        setTimeout(() => {
          tasks[currentTaskIndex].classList.add('status-current');
          updateTaskDisplay();
        }, 300);
      } else {
        setTimeout(() => {
          completedOverlay.classList.add('show');
          setTimeout(() => {
            completedOverlay.classList.remove('show');
            resetTasks();
          }, 3000);
        }, 500);
      }
    }

    function skipTask() {
      if (currentTaskIndex >= tasks.length) return;
      
      tasks[currentTaskIndex].className = 'task-item status-skipped';
      showToast('‚äò –ó–∞–¥–∞—á–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞', 'warning');
      
      currentTaskIndex++;
      
      if (currentTaskIndex < tasks.length) {
        setTimeout(() => {
          tasks[currentTaskIndex].classList.add('status-current');
          updateTaskDisplay();
        }, 300);
      } else {
        setTimeout(() => {
          completedOverlay.classList.add('show');
          setTimeout(() => {
            completedOverlay.classList.remove('show');
            resetTasks();
          }, 3000);
        }, 500);
      }
    }

    function openEditModal() {
      const currentText = taskTitle.textContent;
      editInput.value = currentText;
      editModal.classList.add('show');
      overlay.classList.add('open');
      editInput.focus();
    }

    function closeEditModal() {
      editModal.classList.remove('show');
      overlay.classList.remove('open');
    }

    function saveEdit() {
      const newText = editInput.value.trim();
      if (newText) {
        taskTitle.textContent = newText;
        const taskNumber = currentTaskIndex + 1;
        tasks[currentTaskIndex].textContent = `${taskNumber}. ${newText}`;
        tasks[currentTaskIndex].className = 'task-item status-current';
        showToast('‚úé –ó–∞–¥–∞—á–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞', 'info');
      }
      closeEditModal();
    }

    function resetTasks() {
      currentTaskIndex = 0;
      tasks.forEach((task, index) => {
        task.className = index === 0 ? 'task-item status-current' : 'task-item status-todo';
      });
      updateTaskDisplay();
    }

    // –°–≤–∞–π–ø—ã
    let touchStartX = 0, touchEndX = 0;

    document.addEventListener('touchstart', e => { 
      touchStartX = e.changedTouches[0].screenX; 
    }, { passive: true });
    
    document.addEventListener('touchend', e => {
      touchEndX = e.changedTouches[0].screenX;
      const diff = touchEndX - touchStartX;
      if (diff < -60) openDrawer();
      else if (diff > 60) closeDrawer();
    }, { passive: true });

    // Enter –≤ –º–æ–¥–∞–ª–∫–µ
    editInput.addEventListener('keypress', e => {
      if (e.key === 'Enter') saveEdit();
    });

    // Service Worker
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js')
          .then(() => console.log('Service Worker registered'))
          .catch(err => console.log('SW registration failed:', err));
      });
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    updateTaskDisplay();
  </script>
</body>
    </html>
